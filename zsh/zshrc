if [ $SHLVL = 1 ]; then
    # add local bin path
    export PATH="$HOME/.local/bin:$PATH"
    # Machine specific setting
    source ~/.profile
    # anyenv setup
    eval "$(anyenv init -)"
fi
# starship setup
eval "$(starship init zsh)"

# delete douplicate path
# export PATH=$(echo -n $PATH | awk -v RS=: '!($0 in a) {a[$0]; printf("%s%s", length(a) > 1 ? ":" : "", $0)}')

# rust clippy setting
export CLIPPY_DISABLE_DOCS_LINKS=true

# option setting
setopt histignorealldups sharehistory
setopt auto_cd
unsetopt beep

# Keep 1000 lines of history within the shell and save it to ~/.zsh_history:
HISTSIZE=1000
SAVEHIST=100000
HISTFILE=~/.zsh_history

# 補完
source ~/.zsh/autosuggestions/zsh-autosuggestions.zsh
fpath=(~/.zsh/completions/src $fpath)
autoload -Uz compinit && compinit
zstyle ':completion:*' auto-description 'specify: %d'
zstyle ':completion:*' completer _expand _complete _correct _approximate
zstyle ':completion:*' format 'Completing %d'
zstyle ':completion:*' group-name ''
zstyle ':completion:*' menu select=2
zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' list-colors ''
zstyle ':completion:*' list-prompt %SAt %p: Hit TAB for more, or the character to insert%s
zstyle ':completion:*' matcher-list '' 'm:{a-z}={A-Z}' 'm:{a-zA-Z}={A-Za-z}' 'r:|[._-]=* r:|=* l:|=*'
zstyle ':completion:*' menu select=long
zstyle ':completion:*' select-prompt %SScrolling active: current selection at %p%s
zstyle ':completion:*' use-compctl false
zstyle ':completion:*' verbose true
zstyle ':completion:*:*:kill:*:processes' list-colors '=(#b) #([0-9]#)*=0=01;31'
zstyle ':completion:*:kill:*' command 'ps -u $USER -o pid,%cpu,tty,cputime,cmd'

# alias configuration
alias mkcd=mkcd
alias v='nvim'
alias vimrc="nvim ~/.config/nvim/init.vim"
alias ls='ls --color=auto'
alias ll='ls -l'
alias la='ls -a'
alias l='ls -al'
alias color='for c in {000..255}; do echo -n "\e[38;5;${c}m $c" ; [ $(($c%16)) -eq 15 ] && echo;done;echo'
alias clear='clear -x'
alias size='du -sh ./*'
alias dockerrm='docker rm $(docker ps -aq)'
alias dockerps='docker ps -a'
alias ps='ps auxf'
function mkcd(){
    mkdir $1;
    cd $1;
}

# one character aliases
alias g='git'
alias c='cargo'
alias d='docker'

# alias for git
alias g='git'
alias gs='git status'
alias ga='git add'
alias gaa='git add -A'
alias gg='git graph'
alias gb='git branch'
alias gc='git checkout'
alias gd='git diff'
function gcm {
    git commit -m "$*"
}

if [ "$(uname -a | grep microsoft)" != "" ]; then
    alias shutdown='"/mnt/c/Windows/System32/wsl.exe" --shutdown'
fi

function Tmux {
    tmux $@ >/tmp/tmux.log 2>/tmp/tmux_err.log
    res=$(cat /tmp/tmux.log)
    res_err=$(cat /tmp/tmux_err.log)
    if [ "$res" = "[exited]" ]; then
        exit
    else
        if [ "$res" != "" ]; then
            echo "$res"
        fi
        if [ "$res_err" != "" ]; then
            echo "$res_err"
        fi
    fi
}

if [ "$SSH_CLIENT" = "" ]; then
    if [ "$TMUX" = "" ]; then
        Tmux
    fi
fi
